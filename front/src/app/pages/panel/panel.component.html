<app-header></app-header>

<div class="profile-container bg-[#132D44] py-36" style="background-image: url(assets/hero_background.png);">

    <div data-aos="fade-up" data-aos-duration="1000" class="category-title flex flex-col justify-center items-center mb-24">
        <h1 class="text-4xl font-extrabold text-white text-center">Explorez votre <span class="text-primary600 text-center">panel</span> !</h1>
        <p class="text-xl mt-4 text-neutral500 font-regular text-center">Découvrez vos différentes statistiques liées à votre compte et vos différents historiques !</p>
    </div>

    <div data-aos="fade-up" data-aos-duration="2000" class="rounded-xl bg-[#062037] shadow-shadow-500 shadow-3xl rounded-primary relative mx-auto flex h-full w-full max-w-[650px] flex-col items-center bg-cover bg-clip-border p-[16px] dark:text-white dark:shadow-none pb-10">
        <p class="title mt-1 mb-2 text-primary100">Votre profil</p>
        <div class="relative mt-1 flex h-36 w-full justify-center rounded-xl bg-cover opacity-80 pointer-events-none" style='background-image: url("https://source.unsplash.com/random/900×700/?blue");'>
            <div class="absolute -bottom-12 flex h-[128px] w-[128px] items-center justify-center rounded-full border-[3px] border-primary400 hover:scale-110 transition ease-linear duration-200">
                <img class="h-full w-full rounded-full pointer-events-none" [attr.src]="'https://avatar.oxro.io/avatar.svg?name=' + ((user?.username | uppercase) || '') + '&background=2DA6FF&caps=3&bold=true'" alt="" />
            </div>
        </div>
        <div class="mt-16 flex flex-col items-center">
            <h4 class="text-primary600 text-3xl font-bold">{{ user?.username }}</h4>
            <p class="text-neutral300 text-base font-normal">Joueur</p>
        </div>
        <div class="mt-8 mb-3 flex items-center justify-center gap-4 md:!gap-14">
            <div class="game-played flex flex-col items-center justify-center w-32 hover:scale-110 transition ease-linear duration-200">
                <h3 class="text-3xl font-bold text-primary300">{{ user?.games }}</h3>
                <p class="text-sm font-normal">Parties jouées</p>
            </div>
            <div class="flex flex-col items-center justify-center w-32 hover:scale-110 transition ease-linear duration-200">
                <h3 class="text-3xl font-bold text-primary300">{{ user?.win }}</h3>
                <p class="text-sm font-normal">Victoire(s)</p>
            </div>
            <div class="flex flex-col items-center justify-center w-32 hover:scale-110 transition ease-linear duration-200">
                <h3 class="text-3xl font-bold text-primary300">#{{ user?.ranking | leadingZero }}</h3>
                <p class="text-sm font-normal">sur {{ user?.totalPlayers }} joueurs</p>
            </div>
        </div>
    </div>

    <div data-aos="fade-up" data-aos-duration="1000" class="switcher flex justify-center">
        <div class="flex items-center justify-center mt-16 h-full w-full max-w-[650px]">
            <a 
            (click)="panelSwitch()"
            class="cursor-pointer"
            [class]="displayInventoryPurchases ? 'w-1/2 pb-4 font-medium text-center text-white border-b-2 border-blue-500' : 'w-1/2 pb-4 font-medium text-center border-b border-neutral300 text-neutral300 hover:text-primary100 hover:border-primary100'"
            >
                Consulter vos achats
            </a>
            
            <a 
            (click)="panelSwitch()"
            class="cursor-pointer"
            [class]="displayGameHistory ? 'w-1/2 pb-4 font-medium text-center text-white border-b-2 border-blue-500' : 'w-1/2 pb-4 font-medium text-center border-b border-neutral300 text-neutral300 hover:text-primary100 hover:border-primary100'"
            >
                Consulter vos parties
            </a>
        </div>
    </div>

    <div data-aos="fade-up" data-aos-duration="1000" *ngIf="displayInventoryPurchases" class="inventory mt-8 rounded-xl bg-[#062037] shadow-shadow-500 shadow-3xl rounded-primary relative mx-auto flex h-full w-full max-w-[650px] flex-col items-center bg-cover bg-clip-border p-[16px] dark:text-white dark:shadow-none pb-10">
        <p class="title mt-1 mb-2 text-primary100">Votre inventaire</p>
        <div class="mt-8 mb-3 flex items-center justify-center gap-4 md:!gap-14">
            <div class="glace-map flex flex-col items-center justify-center w-32 hover:scale-110 transition ease-linear duration-200">
                <h3 class="text-bluePrimary text-3xl font-bold text-primary300">Glace</h3>
                <p class="title text-sm text-primary100">Type : Carte</p>
                <p class="mt-2 text-sm font-normal" [ngClass]="{'text-red-500': !Ice, 'text-green-500': Ice}">{{Ice ? 'Possédée' : 'Non possédée'}}</p>
            </div>
            <div class="electricity-map flex flex-col items-center justify-center w-32 hover:scale-110 transition ease-linear duration-200">
                <h3 class="text-bluePrimary text-3xl font-bold text-yellow-400">Électrique</h3>
                <p class="title text-sm text-primary100">Type : Carte</p>
                <p class="mt-2 text-sm font-normal" [ngClass]="{'text-red-500': !Electricity, 'text-green-500': Electricity}">{{Electricity ? 'Possédée' : 'Non possédée'}}</p>
            </div>
            <div class="sugar-map flex flex-col items-center justify-center w-32 hover:scale-110 transition ease-linear duration-200">
                <h3 class="text-bluePrimary text-3xl font-bold text-pink-500">Sucre</h3>
                <p class="title text-sm text-primary100">Type : Carte</p>
                <p class="mt-2 text-sm font-normal" [ngClass]="{'text-red-500': !Sugar, 'text-green-500': Sugar}">{{Sugar ? 'Possédée' : 'Non possédée'}}</p>
            </div>
        </div>
    </div>

    <div data-aos="fade-up" data-aos-duration="1000" *ngIf="displayInventoryPurchases" class="purchases-history mt-8 rounded-xl bg-[#062037] shadow-shadow-500 shadow-3xl rounded-primary relative mx-auto flex h-full w-full max-w-[650px] flex-col items-center bg-cover bg-clip-border p-[16px] dark:text-white dark:shadow-none pb-10">
        <p class="title mt-1 mb-2 text-primary100">Votre historique d'achats</p>

        <div *ngIf="!purchaseHistory || purchaseHistory.length === 0" class="no-games-container">
            <p class="mt-6 text-primary300">Vous n'avez pas encore effectué d'achat.</p>
        </div>

        <div *ngIf="purchaseHistory" class="mt-6 columns-indicators-container flex items-center justify-center">
            <div class="columns-indicators w-[600px] p-2 flex justify-between text-primary200/90 font-medium">
                <p class="w-1/3">Article</p>
                <p class="w-1/3">Prix</p>
                <p class="w-1/3">Date d'achat</p>
            </div>
        </div>
        <div class="mb-3 flex flex-col items-center justify-center gap-1 text-neutral-300">
            <div *ngFor="let purchase of purchaseHistory" class="purchase-record bg-[#001A31] w-[600px] rounded p-2 flex justify-between">
                <p class="w-1/3">Carte : {{purchase.map_name}}</p>
                <p class="w-1/3">500</p>
                <p class="w-1/3">{{purchase.purchase_time | date:'dd/MM/yyyy HH:mm'}}</p>
            </div>
        </div>        
    </div>

    <div data-aos="fade-up" data-aos-duration="1000" *ngIf="displayGameHistory" class="game-history mt-8 rounded-xl bg-[#062037] shadow-shadow-500 shadow-3xl rounded-primary relative mx-auto flex h-full w-full max-w-[650px] flex-col items-center bg-cover bg-clip-border p-[16px] dark:text-white dark:shadow-none pb-10">
        <p class="title mt-1 mb-2 text-primary100">Vos parties multijoueur</p>

        <div *ngIf="gameHistory.length === 0" class="no-games-container">
            <p class="mt-6 text-primary300">Vous n'avez pas encore joué de parties.</p>
        </div>

        <div *ngIf="gameHistory.length > 0" class="mt-6 columns-indicators-container flex items-center justify-center">
            <div class="columns-indicators w-[600px] p-2 flex justify-between text-primary200/90 font-medium">
                <p class="w-1/3">Nombre joueurs</p>
                <p class="w-1/3">Taille plateau</p>
                <p class="w-1/3">Résultat</p>
            </div>
        </div>

        <div class="mb-3 flex flex-col items-center justify-center gap-1 text-neutral-300" *ngFor="let game of gameHistory">
            <div class="game-history-record bg-[#001A31] w-[600px] rounded p-2 flex justify-between">
                <p class="w-1/3">{{ game.player_count }} joueurs</p>
                <p class="w-1/3">{{ game.board_size }}x{{ game.board_size }}</p>
                <p *ngIf="game.result === 'win'" class="cursor-default hover:animate-wiggle w-1/3 text-amber-400 group"><i class="fa-solid fa-trophy mr-2"></i>Gagnant</p>
                <p *ngIf="game.result === 'loss'" class="cursor-default hover:animate-wiggle w-1/3 text-red-500 group"><i class="fa-regular fa-face-frown-open mr-3"></i>Perdant</p>
            </div>
        </div>
    </div>

    <div data-aos="fade-up" data-aos-duration="1000" class="logout-btn flex justify-center mt-8">
        <button (click)="logout()" class="inline-flex bg-[#AF3333]/50 border-2 border-[#FF4646] items-center justify-center h-10 w-32 px-6 font-regular text-base text-white transition duration-200 rounded-lg shadow-md">Déconnexion</button>
    </div>

</div>


<app-footer></app-footer>